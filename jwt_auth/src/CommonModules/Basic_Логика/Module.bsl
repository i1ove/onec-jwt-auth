
// Без I/O: только декодирование и разбор формата "login:password".

Функция РазобратьBasic(Знач ЗначениеBase64) Экспорт
	СтрокаDecoded = УтилитыКодирования.Base64ДекодироватьВСтроку(ЗначениеBase64);
	СтрокаDecoded = СокрЛП(СтрокаDecoded);

	// Формат: login:password (двоеточие обязательно, логин может содержать почти что угодно, но делим по первому ":")
	Позиция = Найти(СтрокаDecoded, ":");
	Если Позиция = 0 Тогда
		ВызватьИсключение "Не авторизован: некорректный формат Basic (ожидалось login:password).";
	КонецЕсли;

	Логин = Лев(СтрокаDecoded, Позиция - 1);
	Пароль = Сред(СтрокаDecoded, Позиция + 1);

	Логин = СокрЛП(Логин);
	// Пароль не тримим агрессивно: допускаем пробелы внутри/в конце, но часто их не бывает.
	// Обрежем только слева/справа, чтобы не ловить случайные переводы строк.
	Пароль = СокрЛП(Пароль);

	Если СтрДлина(Логин) = 0 Тогда
		ВызватьИсключение "Не авторизован: пустой логин в Basic.";
	КонецЕсли;

	Возврат Новый Структура("Логин,Пароль", Логин, Пароль);
КонецФункции
