
Функция СформироватьВход(Знач Запрос) Экспорт

	Параметры = Запрос.ПараметрыЗапроса;
	ВходСыр = HTTPПротоколAPI.СвязатьИПроверить(Схема(), Параметры);
	
	Возврат Новый Структура(
		"Лимит,Сортировка,Порядок",
		ВходСыр.limit,
		ВходСыр.sort,
		ВходСыр.order
	);
КонецФункции

Функция Схема()
	Поля = Новый Соответствие;
	
	// limit: 1..100, default 50
	Поля.Вставить("limit",
		Новый Структура("Тип,Обязательный,ПоУмолчанию,Мин,Макс",
			"Число", Ложь, 50, 1, 100));
	
	// sort: whitelist
	ДопСорт = Новый Массив;
	ДопСорт.Добавить("name");
	
	Поля.Вставить("sort",
		Новый Структура("Тип,Обязательный,ПоУмолчанию,Допустимые,НижнийРегистр",
			"Строка", Ложь, "name", ДопСорт, Ложь));
	
	// order: asc|desc
	ДопОрдер = Новый Массив;
	ДопОрдер.Добавить("asc");
	ДопОрдер.Добавить("desc");
	
	Поля.Вставить("order",
		Новый Структура("Тип,Обязательный,ПоУмолчанию,Допустимые,НижнийРегистр",
			"Строка", Ложь, "asc", ДопОрдер, Истина));
	
	Возврат Новый Структура("СтрогийРежим,Поля", Истина, Поля);
КонецФункции
