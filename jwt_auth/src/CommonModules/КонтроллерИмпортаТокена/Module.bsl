Функция Импортировать(АдресВХ, ИмяФайла) Экспорт
	Порты = КомпозицияХранениеТокенов.СобратьПорты();
	
	Попытка
		// Вызов use case (как у тебя уже есть)
		СценарийИмпортТокена.ВыполнитьСценарий(АдресВХ, Порты);
		
		Возврат Новый Структура("Успех,Сообщение,КодИнцидента",
			Истина,
			"Токен успешно сохранён.",
			"");
		
	Исключение
		КодИнцидента = Строка(Новый УникальныйИдентификатор);
		
		Контекст = Новый Структура;
		Контекст.Вставить("КодИнцидента", КодИнцидента);
		Контекст.Вставить("ИмяФайла", ИмяФайла);
		Контекст.Вставить("АдресВХ", АдресВХ);
		
		ЗаписьЖурналаРегистрации(
			"ИмпортТокена",
			УровеньЖурналаРегистрации.Ошибка,
			,
			"Импорт токена из файла завершился ошибкой. " +
			"Код: " + КодИнцидента + ". " +
			"Ошибка: " + ОписаниеОшибки(),
			Контекст
		);
		
		СообщениеПользователю = "Не удалось сохранить токен. ";
		СообщениеПользователю = СообщениеПользователю +
			"Проверьте файл и повторите. " +
			"Код ошибки: " + КодИнцидента;
		
		Возврат Новый Структура("Успех,Сообщение,КодИнцидента",
			Ложь,
			СообщениеПользователю,
			КодИнцидента);	
	КонецПопытки;
КонецФункции