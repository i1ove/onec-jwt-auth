Функция Разобрать(Знач СтрокаАвторизации) Экспорт
	// Устойчивость к пробелам и табам
	Норм = СтрЗаменить(СокрЛП(СтрокаАвторизации), Символы.Таб, " ");
	
	ПозицияПробела = Найти(Норм, " ");
	Если ПозицияПробела = 0 Тогда
		ВызватьИсключение "Не авторизован: некорректный заголовок Authorization.";
	КонецЕсли;
	
	СыраяСхема = СокрЛП(Лев(Норм, ПозицияПробела - 1));
	Значение = СокрЛП(Сред(Норм, ПозицияПробела + 1));
	
	Если СтрДлина(СыраяСхема) = 0 Или СтрДлина(Значение) = 0 Тогда
		ВызватьИсключение "Не авторизован: некорректный заголовок Authorization.";
	КонецЕсли;
	
	СхемаНиж = НРег(СыраяСхема);
	
	Если СхемаНиж = "bearer" Тогда
		Возврат Новый Структура("Схема,Значение", "Bearer", Значение);
	ИначеЕсли СхемаНиж = "basic" Тогда
		Возврат Новый Структура("Схема,Значение", "Basic", Значение);
	ИначеЕсли СхемаНиж = "pat" Тогда
		Возврат Новый Структура("Схема,Значение", "PAT", Значение);
	Иначе
		ВызватьИсключение "Не авторизован: неподдерживаемая схема Authorization.";
	КонецЕсли;
КонецФункции