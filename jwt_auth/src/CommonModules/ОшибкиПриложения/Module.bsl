
Процедура НеАвторизован(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	ДопИнфо = УтилитыСанитайзера.СанитизироватьЗначение(ДопИнфо, "ВнешнийОтвет", 5, 50, 512);
	
	ВызватьИсключение(
		Сообщение,
		КатегорияОшибки.НарушениеПравДоступа,
		Код,
		ДопИнфо,
		Причина
	);
КонецПроцедуры

Процедура ОшибкаИспользования(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	
	ВызватьИсключение(
		Сообщение,
		КатегорияОшибки.НеподдерживаемыйФормат,
		Код,
		ДопИнфо,
		Причина
	);
КонецПроцедуры

Процедура ОшибкаВалидации(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	
	ВызватьИсключение(
		Сообщение,
		КатегорияОшибки.НеподдерживаемыйФормат,
		Код,
		ДопИнфо,
		Причина
	);
КонецПроцедуры

Процедура ОшибкаДанных(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	// “Ошибка данных” = неверный ввод/нарушение контракта
	ВызватьИсключение(Сообщение, КатегорияОшибки.ОшибкаКонфигурации, Код, ДопИнфо, Причина);
КонецПроцедуры

Процедура ДоступЗапрещен(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	ДопИнфо = УтилитыСанитайзера.СанитизироватьЗначение(ДопИнфо, "ВнешнийОтвет", 5, 50, 512);
	
	ВызватьИсключение(
		Сообщение,
		КатегорияОшибки.НарушениеПравДоступа,
		Код,
		ДопИнфо,
		Причина
	);
КонецПроцедуры

Процедура ОшибкаКонфигурации(Знач Сообщение, Знач Код, Знач ДопИнфо = Неопределено, Знач Причина = Неопределено) Экспорт
	ДопИнфо = УтилитыСанитайзера.СанитизироватьЗначение(ДопИнфо, "ВнешнийОтвет", 5, 50, 512);
	
	ВызватьИсключение(
		Сообщение,
		КатегорияОшибки.ОшибкаКонфигурации,
		Код,
		ДопИнфо,
		Причина
	);
КонецПроцедуры

Функция ДопИнфоДоступа(Знач ВходАвторизации, Знач Схема = "", Знач Субъект = Неопределено, Знач ТребуемаяОбласть = "", Знач Логин = "") Экспорт
	Доп = Новый Структура;

	Если ТипЗнч(ВходАвторизации) = Тип("Структура") Тогда
		Если ВходАвторизации.Свойство("Корреляция") Тогда
			Доп.Вставить("Корреляция", Строка(ВходАвторизации.Корреляция));
		КонецЕсли;
		Если ВходАвторизации.Свойство("Операция") Тогда
			Доп.Вставить("Операция", Строка(ВходАвторизации.Операция));
		КонецЕсли;
		Если ВходАвторизации.Свойство("Транспорт") Тогда
			Доп.Вставить("Транспорт", Строка(ВходАвторизации.Транспорт));
		КонецЕсли;
		Если ВходАвторизации.Свойство("Клиент") Тогда
			Доп.Вставить("Клиент", Строка(ВходАвторизации.Клиент));
		КонецЕсли;
	КонецЕсли;

	Если СтрДлина(СокрЛП(Схема)) > 0 Тогда
		Доп.Вставить("Схема", Схема);
	КонецЕсли;

	Если СтрДлина(СокрЛП(ТребуемаяОбласть)) > 0 Тогда
		Доп.Вставить("ТребуемаяОбласть", НРег(СокрЛП(ТребуемаяОбласть)));
	КонецЕсли;

	Если СтрДлина(СокрЛП(Логин)) > 0 Тогда
		Доп.Вставить("Логин", Логин);
	КонецЕсли;

	Если ТипЗнч(Субъект) = Тип("Структура") Тогда
		Если Субъект.Свойство("ИдентификаторПользователя") И Субъект.ИдентификаторПользователя <> Неопределено Тогда
			Доп.Вставить("ИдентификаторПользователя", Строка(Субъект.ИдентификаторПользователя));
		КонецЕсли;
		Если Субъект.Свойство("ИдентификаторТокена") И Субъект.ИдентификаторТокена <> Неопределено Тогда
			Доп.Вставить("ИдентификаторТокена", Строка(Субъект.ИдентификаторТокена));
		КонецЕсли;
	КонецЕсли;

	Возврат УтилитыСанитайзера.СанитизироватьЗначение(Доп, "ВнешнийОтвет", 5, 50, 512);
КонецФункции